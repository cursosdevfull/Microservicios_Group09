"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const express_1=__importDefault(require("express")),Parameters_1=__importDefault(require("./helpers/Parameters")),user_application_1=require("./module/application/user.application"),user_infrastructure_1=require("./module/infrastructure/user.infrastructure"),routes_1=__importDefault(require("./module/interfaces/http/routes")),user_controller_1=__importDefault(require("./module/interfaces/http/user.controller"));class App{constructor(e){this.controller=e,this.expressApp=(0,express_1.default)(),this.mountMiddlewares(),this.mountRoutes(),this.mountErrorHandlers()}mountMiddlewares(){this.expressApp.use(express_1.default.json()),this.expressApp.use(express_1.default.urlencoded({extended:!0}))}mountRoutes(){this.expressApp.use("/api",new routes_1.default(this.controller).router)}mountErrorHandlers(){this.expressApp.use(((e,r,t,s)=>{const u={name:e.name,message:e.message};"development"===Parameters_1.default.ENVIRONMENT&&(u.stack=e.stack),t.status(e.status||500).json(u)}))}get app(){return this.expressApp}}const userInfrastructure=new user_infrastructure_1.UserInfrastructure,userApplication=new user_application_1.UserApplication(userInfrastructure),userController=new user_controller_1.default(userApplication);exports.default=new App(userController).app;